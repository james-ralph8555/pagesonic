const z=(e,t)=>e===t,H=Symbol("solid-track"),L={equals:z};let _=Q;const S=1,N=2,B={owned:null,cleanups:null,context:null,owner:null};var c=null;let M=null,J=null,o=null,a=null,m=null,F=0;function R(e,t){const n=o,s=c,l=e.length===0,u=t===void 0?s:t,i=l?B:{owned:null,cleanups:null,context:u?u.context:null,owner:u},f=l?e:()=>e(()=>x(()=>k(i)));c=i,o=null;try{return O(f,!0)}finally{o=n,c=s}}function X(e,t){t=t?Object.assign({},L,t):L;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},s=l=>(typeof l=="function"&&(l=l(n.value)),P(n,l));return[G.bind(n),s]}function ie(e,t,n){const s=j(e,t,!1,S);C(s)}function Y(e,t,n){_=ne;const s=j(e,t,!1,S);s.user=!0,m?m.push(s):C(s)}function Z(e,t,n){n=n?Object.assign({},L,n):L;const s=j(e,t,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,C(s),G.bind(s)}function x(e){if(o===null)return e();const t=o;o=null;try{return e()}finally{o=t}}function oe(e){Y(()=>x(e))}function ee(e){return c===null||(c.cleanups===null?c.cleanups=[e]:c.cleanups.push(e)),e}function G(){if(this.sources&&this.state)if(this.state===S)C(this);else{const e=a;a=null,O(()=>T(this),!1),a=e}if(o){const e=this.observers?this.observers.length:0;o.sources?(o.sources.push(this),o.sourceSlots.push(e)):(o.sources=[this],o.sourceSlots=[e]),this.observers?(this.observers.push(o),this.observerSlots.push(o.sources.length-1)):(this.observers=[o],this.observerSlots=[o.sources.length-1])}return this.value}function P(e,t,n){let s=e.value;return(!e.comparator||!e.comparator(s,t))&&(e.value=t,e.observers&&e.observers.length&&O(()=>{for(let l=0;l<e.observers.length;l+=1){const u=e.observers[l],i=M&&M.running;i&&M.disposed.has(u),(i?!u.tState:!u.state)&&(u.pure?a.push(u):m.push(u),u.observers&&W(u)),i||(u.state=S)}if(a.length>1e6)throw a=[],new Error},!1)),t}function C(e){if(!e.fn)return;k(e);const t=F;te(e,e.value,t)}function te(e,t,n){let s;const l=c,u=o;o=c=e;try{s=e.fn(t)}catch(i){return e.pure&&(e.state=S,e.owned&&e.owned.forEach(k),e.owned=null),e.updatedAt=n+1,$(i)}finally{o=u,c=l}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?P(e,s):e.value=s,e.updatedAt=n)}function j(e,t,n,s=S,l){const u={fn:e,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:c,context:c?c.context:null,pure:n};return c===null||c!==B&&(c.owned?c.owned.push(u):c.owned=[u]),u}function D(e){if(e.state===0)return;if(e.state===N)return T(e);if(e.suspense&&x(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<F);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===S)C(e);else if(e.state===N){const s=a;a=null,O(()=>T(e,t[0]),!1),a=s}}function O(e,t){if(a)return e();let n=!1;t||(a=[]),m?n=!0:m=[],F++;try{const s=e();return se(n),s}catch(s){n||(m=null),a=null,$(s)}}function se(e){if(a&&(Q(a),a=null),e)return;const t=m;m=null,t.length&&O(()=>_(t),!1)}function Q(e){for(let t=0;t<e.length;t++)D(e[t])}function ne(e){let t,n=0;for(t=0;t<e.length;t++){const s=e[t];s.user?e[n++]=s:D(s)}for(t=0;t<n;t++)D(e[t])}function T(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const s=e.sources[n];if(s.sources){const l=s.state;l===S?s!==t&&(!s.updatedAt||s.updatedAt<F)&&D(s):l===N&&T(s,t)}}}function W(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=N,n.pure?a.push(n):m.push(n),n.observers&&W(n))}}function k(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),s=e.sourceSlots.pop(),l=n.observers;if(l&&l.length){const u=l.pop(),i=n.observerSlots.pop();s<l.length&&(u.sourceSlots[i]=s,l[s]=u,n.observerSlots[s]=i)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)k(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)k(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function re(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function $(e,t=c){throw re(e)}const le=Symbol("fallback");function K(e){for(let t=0;t<e.length;t++)e[t]()}function ue(e,t,n={}){let s=[],l=[],u=[],i=0,f=t.length>1?[]:null;return ee(()=>K(u)),()=>{let g=e()||[],p=g.length,h,r;return g[H],x(()=>{let A,d,E,I,U,w,b,v,y;if(p===0)i!==0&&(K(u),u=[],s=[],l=[],i=0,f&&(f=[])),n.fallback&&(s=[le],l[0]=R(q=>(u[0]=q,n.fallback())),i=1);else if(i===0){for(l=new Array(p),r=0;r<p;r++)s[r]=g[r],l[r]=R(V);i=p}else{for(E=new Array(p),I=new Array(p),f&&(U=new Array(p)),w=0,b=Math.min(i,p);w<b&&s[w]===g[w];w++);for(b=i-1,v=p-1;b>=w&&v>=w&&s[b]===g[v];b--,v--)E[v]=l[b],I[v]=u[b],f&&(U[v]=f[b]);for(A=new Map,d=new Array(v+1),r=v;r>=w;r--)y=g[r],h=A.get(y),d[r]=h===void 0?-1:h,A.set(y,r);for(h=w;h<=b;h++)y=s[h],r=A.get(y),r!==void 0&&r!==-1?(E[r]=l[h],I[r]=u[h],f&&(U[r]=f[h]),r=d[r],A.set(y,r)):u[h]();for(r=w;r<p;r++)r in E?(l[r]=E[r],u[r]=I[r],f&&(f[r]=U[r],f[r](r))):l[r]=R(V);l=l.slice(0,i=p),s=g.slice(0)}return l});function V(A){if(u[r]=A,f){const[d,E]=X(r);return f[r]=E,t(g[r],d)}return t(g[r])}}}function ce(e,t){return x(()=>e(t||{}))}function ae(e){const t="fallback"in e&&{fallback:()=>e.fallback};return Z(ue(()=>e.each,e.children,t||void 0))}export{ae as F,ie as a,Z as b,R as c,X as d,Y as e,ee as f,ce as g,oe as o,x as u};
